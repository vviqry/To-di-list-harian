<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>To-Do List Harian</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f0e1;
            display: flex;
            justify-content: center;
        }

        .container {
            max-width: 600px;
            width: 100%;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            position: relative;
        }

        h1 {
            text-align: center;
            color: #333;
            font-size: 24px;
            margin-bottom: 20px;
        }

        .coin-button {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: #1ed900;
            border: 2px solid #308322;
            border-radius: 5px;
            padding: 5px;
            font-size: 24px;
            cursor: pointer;
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            transition: background-color 0.3s;
        }

        .coin-button:hover {
            background-color: #117a00;
        }

        .coin-button i {
            margin: 0;
        }

        h2 {
            font-size: 18px;
            color: #444;
            margin: 15px 0 10px;
        }

        .subcategory {
            margin-left: 20px;
            font-size: 16px;
            color: #555;
        }

        .todo-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 5px 0;
            font-size: 14px;
        }

        .todo-item input[type="checkbox"] {
            width: 16px;
            height: 16px;
        }

        .progress-section {
            margin: 10px 0;
            text-align: center;
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background-color: #ddd;
            border-radius: 5px;
            overflow: hidden;
        }

        .progress {
            height: 100%;
            background-color: #4caf50;
            width: 0;
            transition: width 0.3s;
        }

        .progress-text {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }

        .divider {
            border-top: 1px dashed #ccc;
            margin: 20px 0;
            text-align: center;
            color: #999;
            font-size: 12px;
        }

        .divider::before,
        .divider::after {
            content: "----------------------------------";
            color: #ccc;
        }

        .divider span {
            padding: 0 10px;
        }

        .quote {
            text-align: center;
            font-style: italic;
            color: #666;
            margin-top: 20px;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <button class="coin-button" onclick="window.open('https://vviqry.github.io/Kalender-Cuan/', '_blank')">
            <i class="bi bi-coin"></i>
        </button>
        <h1>To-Do List Harian</h1>

        <h2>1. Kuliah</h2>
        <div class="todo-item">
            <input type="checkbox" id="kuliah-si" onchange="updateCheckbox('kuliah-si')">
            <label for="kuliah-si">Sistem Informasi</label>
        </div>
        <div class="todo-item">
            <input type="checkbox" id="kuliah-matematika" onchange="updateCheckbox('kuliah-matematika')">
            <label for="kuliah-matematika">Pengantar Matematika</label>
        </div>
        <div class="todo-item">
            <input type="checkbox" id="kuliah-kalkulus" onchange="updateCheckbox('kuliah-kalkulus')">
            <label for="kuliah-kalkulus">Kalkulus</label>
        </div>
        <div class="todo-item">
            <input type="checkbox" id="kuliah-bahasa" onchange="updateCheckbox('kuliah-bahasa')">
            <label for="kuliah-bahasa">Bahasa Indo</label>
        </div>
        <div class="todo-item">
            <input type="checkbox" id="kuliah-agama" onchange="updateCheckbox('kuliah-agama')">
            <label for="kuliah-agama">Agama</label>
        </div>
        <div class="todo-item">
            <input type="checkbox" id="kuliah-pkn" onchange="updateCheckbox('kuliah-pkn')">
            <label for="kuliah-pkn">PKN</label>
        </div>

        <div class="divider"><span>GARIS</span></div>

        <h2>2. Produktif (Tiktok Mukbang)</h2>
        <div class="subcategory">Rumus 136 (1 hari 3 konten selama 6 bulan)</div>
        <div class="todo-item">
            <input type="checkbox" id="produktif-136-mukbang" disabled>
            <label for="produktif-136-mukbang">Done</label>
        </div>
        <div class="progress-section">
            <div class="progress-bar">
                <div class="progress" id="progress-136-mukbang"></div>
            </div>
            <div class="progress-text" id="progress-text-136-mukbang">Progres: 0%</div>
        </div>
        <div class="subcategory">Rumus 111519</div>
        <div class="todo-item">
            <input type="checkbox" id="produktif-111519-11-mukbang" onchange="updateCheckbox('produktif-111519-11-mukbang')">
            <label for="produktif-111519-11-mukbang">Upload jam 11.00</label>
        </div>
        <div class="todo-item">
            <input type="checkbox" id="produktif-111519-15-mukbang" onchange="updateCheckbox('produktif-111519-15-mukbang')">
            <label for="produktif-111519-15-mukbang">Upload jam 15.00</label>
        </div>
        <div class="todo-item">
            <input type="checkbox" id="produktif-111519-19-mukbang" onchange="updateCheckbox('produktif-111519-19-mukbang')">
            <label for="produktif-111519-19-mukbang">Upload jam 19.00</label>
        </div>

        <div class="divider"><span>GARIS</span></div>

        <h2>3. Produktif (Tiktok Skincare)</h2>
        <div class="subcategory">Rumus 136 (1 hari 3 konten selama 6 bulan)</div>
        <div class="todo-item">
            <input type="checkbox" id="produktif-136-skincare" disabled>
            <label for="produktif-136-skincare">Done</label>
        </div>
        <div class="progress-section">
            <div class="progress-bar">
                <div class="progress" id="progress-136-skincare"></div>
            </div>
            <div class="progress-text" id="progress-text-136-skincare">Progres: 0%</div>
        </div>
        <div class="subcategory">Rumus 111519</div>
        <div class="todo-item">
            <input type="checkbox" id="produktif-111519-11-skincare" onchange="updateCheckbox('produktif-111519-11-skincare')">
            <label for="produktif-111519-11-skincare">Upload jam 11.00</label>
        </div>
        <div class="todo-item">
            <input type="checkbox" id="produktif-111519-15-skincare" onchange="updateCheckbox('produktif-111519-15-skincare')">
            <label for="produktif-111519-15-skincare">Upload jam 15.00</label>
        </div>
        <div class="todo-item">
            <input type="checkbox" id="produktif-111519-19-skincare" onchange="updateCheckbox('produktif-111519-19-skincare')">
            <label for="produktif-111519-19-skincare">Upload jam 19.00</label>
        </div>

        <div class="divider"><span>GARIS</span></div>

        <h2>4. Produktif (Tiktok Manoutfit)</h2>
        <div class="subcategory">Rumus 136 (1 hari 3 konten selama 6 bulan)</div>
        <div class="todo-item">
            <input type="checkbox" id="produktif-136-manoutfit" disabled>
            <label for="produktif-136-manoutfit">Done</label>
        </div>
        <div class="progress-section">
            <div class="progress-bar">
                <div class="progress" id="progress-136-manoutfit"></div>
            </div>
            <div class="progress-text" id="progress-text-136-manoutfit">Progres: 0%</div>
        </div>
        <div class="subcategory">Rumus 111519</div>
        <div class="todo-item">
            <input type="checkbox" id="produktif-111519-11-manoutfit" onchange="updateCheckbox('produktif-111519-11-manoutfit')">
            <label for="produktif-111519-11-manoutfit">Upload jam 11.00</label>
        </div>
        <div class="todo-item">
            <input type="checkbox" id="produktif-111519-15-manoutfit" onchange="updateCheckbox('produktif-111519-15-manoutfit')">
            <label for="produktif-111519-15-manoutfit">Upload jam 15.00</label>
        </div>
        <div class="todo-item">
            <input type="checkbox" id="produktif-111519-19-manoutfit" onchange="updateCheckbox('produktif-111519-19-manoutfit')">
            <label for="produktif-111519-19-manoutfit">Upload jam 19.00</label>
        </div>

        <div class="quote">"Lakukan & Lupakan"</div>
    </div>

    <script>
// Tanggal hari ini
const today = new Date();
const startDate = new Date('2025-05-16T07:51:00+07:00');
const endDateProduktif = new Date('2025-11-30T23:59:59+07:00');
const totalDaysProduktif = Math.ceil((endDateProduktif - startDate) / (1000 * 60 * 60 * 24)) + 1;

// Default state structure
const defaultState = {
    lastReset: today.toISOString().split('T')[0],
    lastDailyReset: today.toISOString().split('T')[0],
    kuliah: {
        'kuliah-si': false,
        'kuliah-matematika': false,
        'kuliah-kalkulus': false,
        'kuliah-bahasa': false,
        'kuliah-agama': false,
        'kuliah-pkn': false
    },
    produktif: {
        mukbang: {
            'produktif-111519-11-mukbang': false,
            'produktif-111519-15-mukbang': false,
            'produktif-111519-19-mukbang': false
        },
        skincare: {
            'produktif-111519-11-skincare': false,
            'produktif-111519-15-skincare': false,
            'produktif-111519-19-skincare': false
        },
        manoutfit: {
            'produktif-111519-11-manoutfit': false,
            'produktif-111519-15-manoutfit': false,
            'produktif-111519-19-manoutfit': false
        }
    },
    progress: {
        '136-mukbang': [],
        '136-skincare': [],
        '136-manoutfit': []
    }
};

// Ambil data dari localStorage dengan fallback ke defaultState
let state;
try {
    state = JSON.parse(localStorage.getItem('todoState')) || defaultState;
    // Validate state structure
    if (!state.produktif || !state.produktif.mukbang || !state.produktif.skincare || !state.produktif.manoutfit) {
        state = defaultState;
    }
} catch (e) {
    state = defaultState;
}

// Fungsi untuk mendapatkan nomor minggu dalam setahun
function getWeekNumber(date) {
    const firstDayOfYear = new Date(date.getFullYear(), 0, 1);
    const pastDaysOfYear = (date - firstDayOfYear) / 86400000;
    return Math.ceil((pastDaysOfYear + firstDayOfYear.getDay() + 1) / 7);
}

// Reset checkbox Kuliah tiap minggu
function resetWeeklyCheckboxes() {
    const currentWeek = getWeekNumber(today);
    const lastResetDate = new Date(state.lastReset);
    const lastResetWeek = getWeekNumber(lastResetDate);

    if (currentWeek !== lastResetWeek) {
        Object.keys(state.kuliah).forEach(key => state.kuliah[key] = false);
        state.lastReset = today.toISOString().split('T')[0];
        localStorage.setItem('todoState', JSON.stringify(state));
    }
}

// Reset checkbox Produktif tiap hari jam 1 pagi
function resetDailyCheckboxes() {
    const currentDate = today.toISOString().split('T')[0];
    const lastDailyReset = state.lastDailyReset;

    if (currentDate !== lastDailyReset) {
        Object.values(state.produktif).forEach(category => {
            Object.keys(category).forEach(key => category[key] = false);
        });
        state.lastDailyReset = currentDate;
        localStorage.setItem('todoState', JSON.stringify(state));
    }
}

// Update checkbox dan progress
function updateCheckbox(id) {
    const checkbox = document.getElementById(id);
    const isChecked = checkbox.checked;
    const currentDate = today.toISOString().split('T')[0];

    // Update state berdasarkan kategori
    if (id.startsWith('kuliah')) {
        state.kuliah[id] = isChecked;
    } else if (id.startsWith('produktif')) {
        const platform = id.split('-').pop();
        if (state.produktif[platform]) {
            state.produktif[platform][id] = isChecked;
            
            const group = [
                `produktif-111519-11-${platform}`,
                `produktif-111519-15-${platform}`,
                `produktif-111519-19-${platform}`
            ];
            
            // Update status produktif-136 berdasarkan ketiga checkbox
            const allChecked = group.every(g => state.produktif[platform][g]);
            document.getElementById(`produktif-136-${platform}`).checked = allChecked;
            
            if (allChecked && !state.progress[`136-${platform}`].includes(currentDate)) {
                state.progress[`136-${platform}`].push(currentDate);
            }
        }
    }

    localStorage.setItem('todoState', JSON.stringify(state));
    updateProgress();
    renderCheckboxes();
}

// Update progress bar
function updateProgress() {
    ['mukbang', 'skincare', 'manoutfit'].forEach(platform => {
        const progress136 = state.progress[`136-${platform}`].length;
        const percentage136 = (progress136 / totalDaysProduktif) * 100;
        document.getElementById(`progress-136-${platform}`).style.width = `${percentage136}%`;
        document.getElementById(`progress-text-136-${platform}`).textContent = `Progres: ${Math.round(percentage136)}%`;
    });
}

// Render status checkbox dari state
function renderCheckboxes() {
    Object.keys(state.kuliah).forEach(id => {
        const checkbox = document.getElementById(id);
        if (checkbox) checkbox.checked = state.kuliah[id];
    });
    
    ['mukbang', 'skincare', 'manoutfit'].forEach(platform => {
        const group = [
            `produktif-111519-11-${platform}`,
            `produktif-111519-15-${platform}`,
            `produktif-111519-19-${platform}`
        ];
        group.forEach(id => {
            const checkbox = document.getElementById(id);
            if (checkbox && state.produktif[platform]) {
                checkbox.checked = state.produktif[platform][id] || false;
            }
        });
        const doneCheckbox = document.getElementById(`produktif-136-${platform}`);
        if (doneCheckbox && state.produktif[platform]) {
            doneCheckbox.checked = group.every(id => state.produktif[platform][id]);
        }
    });
}

// Inisialisasi
document.addEventListener('DOMContentLoaded', () => {
    resetWeeklyCheckboxes();
    resetDailyCheckboxes();
    renderCheckboxes();
    updateProgress();
});
</script>
</body>
</html>
