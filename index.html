<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>To-Do List Harian</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f0e1;
            display: flex;
            justify-content: center;
        }

        .container {
            max-width: 600px;
            width: 100%;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            position: relative; /* Biar tombol bisa diposisi absolut */
        }

        h1 {
            text-align: center;
            color: #333;
            font-size: 24px;
            margin-bottom: 20px;
        }

        .coin-button {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: #1ed900; /* Warna emas untuk kotak */
            border: 2px solid #308322; /* Border kotak */
            border-radius: 5px; /* Membuat sudut kotak agak melengkung */
            padding: 5px;
            font-size: 24px;
            cursor: pointer;
            color: #fff; /* Warna ikon jadi putih biar kontras */
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            transition: background-color 0.3s;
        }

        .coin-button:hover {
            background-color: #117a00; /* Hover effect */
        }

        .coin-button i {
            margin margin-top: 9px; /* Hapus margin default dari ikon */
            margin-bottom: 0px;
            align-items: center;
        }

        h2 {
            font-size: 18px;
            color: #444;
            margin: 15px 0 10px;
        }

        .subcategory {
            margin-left: 20px;
            font-size: 16px;
            color: #555;
        }

        .todo-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 5px 0;
            font-size: 14px;
        }

        .todo-item input[type="checkbox"] {
            width: 16px;
            height: 16px;
        }

        .progress-section {
            margin: 10px 0;
            text-align: center;
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background-color: #ddd;
            border-radius: 5px;
            overflow: hidden;
        }

        .progress {
            height: 100%;
            background-color: #4caf50;
            width: 0;
            transition: width 0.3s;
        }

        .progress-text {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }

        .divider {
            border-top: 1px dashed #ccc;
            margin: 20px 0;
            text-align: center;
            color: #999;
            font-size: 12px;
        }

        .divider::before,
        .divider::after {
            content: "----------------------------------";
            color: #ccc;
        }

        .divider span {
            padding: 0 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <button class="coin-button" onclick="window.open('https://vviqry.github.io/Kalender-Cuan/', '_blank')">
            <i class="bi bi-coin"></i>
        </button>
        <h1>To-Do List Harian</h1>

        <h2>1. Kuliah</h2>
        <div class="todo-item">
            <input type="checkbox" id="kuliah-si" onchange="updateCheckbox('kuliah-si')">
            <label for="kuliah-si">Sistem Informasi</label>
        </div>
        <div class="todo-item">
            <input type="checkbox" id="kuliah-matematika" onchange="updateCheckbox('kuliah-matematika')">
            <label for="kuliah-matematika">Pengantar Matematika</label>
        </div>
        <div class="todo-item">
            <input type="checkbox" id="kuliah-kalkulus" onchange="updateCheckbox('kuliah-kalkulus')">
            <label for="kuliah-kalkulus">Kalkulus</label>
        </div>
        <div class="todo-item">
            <input type="checkbox" id="kuliah-bahasa" onchange="updateCheckbox('kuliah-bahasa')">
            <label for="kuliah-bahasa">Bahasa Indo</label>
        </div>
        <div class="todo-item">
            <input type="checkbox" id="kuliah-agama" onchange="updateCheckbox('kuliah-agama')">
            <label for="kuliah-agama">Agama</label>
        </div>
        <div class="todo-item">
            <input type="checkbox" id="kuliah-pkn" onchange="updateCheckbox('kuliah-pkn')">
            <label for="kuliah-pkn">PKN</label>
        </div>

        <div class="divider"><span>GARIS</span></div>

        <h2>2. Produktif</h2>
        <div class="subcategory">Rumus 136 (1 hari 3 konten selama 6 bulan)</div>
        <div class="todo-item">
            <input type="checkbox" id="produktif-136" onchange="updateCheckbox('produktif-136')">
            <label for="produktif-136">Done</label>
        </div>
        <div class="progress-section">
            <div class="progress-bar">
                <div class="progress" id="progress-136"></div>
            </div>
            <div class="progress-text" id="progress-text-136">Progres: 0%</div>
        </div>

        <div class="subcategory">Rumus 111519</div>
        <div class="todo-item">
            <input type="checkbox" id="produktif-111519-11" onchange="updateCheckbox('produktif-111519-11')">
            <label for="produktif-111519-11">Upload jam 11.00</label>
        </div>
        <div class="todo-item">
            <input type="checkbox" id="produktif-111519-15" onchange="updateCheckbox('produktif-111519-15')">
            <label for="produktif-111519-15">Upload jam 15.00</label>
        </div>
        <div class="todo-item">
            <input type="checkbox" id="produktif-111519-19" onchange="updateCheckbox('produktif-111519-19')">
            <label for="produktif-111519-19">Upload jam 19.00</label>
        </div>
        <div class="progress-section">
            <div class="progress-bar">
                <div class="progress" id="progress-111519"></div>
            </div>
            <div class="progress-text" id="progress-text-111519">Progres: 0%</div>
        </div>

        <h2>3. Running Honeygain</h2>
        <div class="todo-item">
            <input type="checkbox" id="honeygain" onchange="updateCheckbox('honeygain')">
            <label for="honeygain">Done</label>
        </div>
        <div class="progress-section">
            <div class="progress-bar">
                <div class="progress" id="progress-honeygain"></div>
            </div>
            <div class="progress-text" id="progress-text-honeygain">Progres: 0%</div>
        </div>
    </div>

    <script>
        // Tanggal hari ini (sesuai sistem: 08:41 AM WIB, 14 Mei 2025)
        const today = new Date('2025-05-14T08:41:00+07:00');
        const startDate = new Date('2025-05-14T08:41:00+07:00'); // Mulai dari tanggal ini

        // Tanggal akhir untuk progress bar
        const endDateProduktif = new Date('2025-11-30T23:59:59+07:00'); // Akhir November 2025
        const endDateHoneygain = new Date('2025-10-31T23:59:59+07:00'); // Akhir Oktober 2025

        // Hitung total hari untuk progress bar
        const totalDaysProduktif = Math.ceil((endDateProduktif - startDate) / (1000 * 60 * 60 * 24)) + 1;
        const totalDaysHoneygain = Math.ceil((endDateHoneygain - startDate) / (1000 * 60 * 60 * 24)) + 1;

        // Ambil data dari localStorage
        let state = JSON.parse(localStorage.getItem('todoState')) || {
            lastReset: today.toISOString().split('T')[0],
            kuliah: {
                'kuliah-si': false,
                'kuliah-matematika': false,
                'kuliah-kalkulus': false,
                'kuliah-bahasa': false,
                'kuliah-agama': false,
                'kuliah-pkn': false
            },
            produktif: {
                'produktif-136': false,
                'produktif-111519-11': false,
                'produktif-111519-15': false,
                'produktif-111519-19': false
            },
            honeygain: { 'honeygain': false },
            progress: {
                '136': [],
                '111519': [],
                'honeygain': []
            }
        };

        // Fungsi untuk mendapatkan nomor minggu dalam setahun
        function getWeekNumber(date) {
            const firstDayOfYear = new Date(date.getFullYear(), 0, 1);
            const pastDaysOfYear = (date - firstDayOfYear) / 86400000;
            return Math.ceil((pastDaysOfYear + firstDayOfYear.getDay() + 1) / 7);
        }

        // Reset checkbox Kuliah dan Produktif tiap minggu
        function resetWeeklyCheckboxes() {
            const currentWeek = getWeekNumber(today);
            const lastResetDate = new Date(state.lastReset);
            const lastResetWeek = getWeekNumber(lastResetDate);

            if (currentWeek !== lastResetWeek) {
                Object.keys(state.kuliah).forEach(key => state.kuliah[key] = false);
                Object.keys(state.produktif).forEach(key => state.produktif[key] = false);
                state.lastReset = today.toISOString().split('T')[0];
                localStorage.setItem('todoState', JSON.stringify(state));
            }
        }

        // Update checkbox dan progress
        function updateCheckbox(id) {
            const checkbox = document.getElementById(id);
            const isChecked = checkbox.checked;
            const currentDate = today.toISOString().split('T')[0];

            // Update state berdasarkan kategori
            if (id.startsWith('kuliah')) {
                state.kuliah[id] = isChecked;
            } else if (id.startsWith('produktif')) {
                state.produktif[id] = isChecked;
                if (isChecked) {
                    if (id === 'produktif-136' && !state.progress['136'].includes(currentDate)) {
                        state.progress['136'].push(currentDate);
                    } else if (id.startsWith('produktif-111519')) {
                        const group = ['produktif-111519-11', 'produktif-111519-15', 'produktif-111519-19'];
                        if (group.includes(id) && group.every(g => state.produktif[g]) && !state.progress['111519'].includes(currentDate)) {
                            state.progress['111519'].push(currentDate);
                        }
                    }
                }
            } else if (id === 'honeygain') {
                state.honeygain[id] = isChecked;
                if (isChecked && !state.progress['honeygain'].includes(currentDate)) {
                    state.progress['honeygain'].push(currentDate);
                }
            }

            localStorage.setItem('todoState', JSON.stringify(state));
            updateProgress();
            renderCheckboxes();
        }

        // Update progress bar
        function updateProgress() {
            // Progress untuk Rumus 136
            const progress136 = state.progress['136'].length;
            const percentage136 = (progress136 / totalDaysProduktif) * 100;
            document.getElementById('progress-136').style.width = `${percentage136}%`;
            document.getElementById('progress-text-136').textContent = `Progres: ${Math.round(percentage136)}%`;

            // Progress untuk Rumus 111519
            const progress111519 = state.progress['111519'].length;
            const percentage111519 = (progress111519 / totalDaysProduktif) * 100;
            document.getElementById('progress-111519').style.width = `${percentage111519}%`;
            document.getElementById('progress-text-111519').textContent = `Progres: ${Math.round(percentage111519)}%`;

            // Progress untuk Honeygain
            const progressHoneygain = state.progress['honeygain'].length;
            const percentageHoneygain = (progressHoneygain / totalDaysHoneygain) * 100;
            document.getElementById('progress-honeygain').style.width = `${percentageHoneygain}%`;
            document.getElementById('progress-text-honeygain').textContent = `Progres: ${Math.round(percentageHoneygain)}%`;
        }

        // Render status checkbox dari state
        function renderCheckboxes() {
            Object.keys(state.kuliah).forEach(id => {
                document.getElementById(id).checked = state.kuliah[id];
            });
            Object.keys(state.produktif).forEach(id => {
                document.getElementById(id).checked = state.produktif[id];
            });
            Object.keys(state.honeygain).forEach(id => {
                document.getElementById(id).checked = state.honeygain[id];
            });
        }

        // Inisialisasi
        document.addEventListener('DOMContentLoaded', () => {
            resetWeeklyCheckboxes();
            renderCheckboxes();
            updateProgress();
        });
    </script>
</body>
</html>